#line 1 "/home/lord448/Documentos/TEC/Tesis/VideojuegoCRITRepo/ESPMCU/ShoulderWheel/README.md"
# ESP32 Shoulder Wheel
Makes the connection and acquires the angle information with
a MPU6050 Sensor, for physical connections check the README.md, the ESP32
sends fixed strings to notify to the mobile the current status of the
embedded device

## Physical connections
ESP32 will be connected to the MPU6050 sensor using the I2C pins of the ESP32 specified here:

| Pin map | ESP32 | MPU6050 |
| :---:   | :---: |  :---:  |
| SDA     |       |         |
| SCL     |       |         |

## Butterworth Low pass filter
The EPS32 implements a low pass filter with a 30Hz cutoff frequency
that helps with the noise generated by the MPU6050 sensor below you can find the functions and transfer functiosn needed for the implemented sensor

The frequency of the filter were selected focusing more on avoiding the wave disphasing than the 

**Continuos transfer function of a Nth order Butterworth filter:**
$$ H(s) = { 1 \over{\sum_{k=1}^n {a_k \over {\omega_0}^k}} s^k } $$

where:

$$ a_{k+1} = {{\cos({k\gamma})} \over \sin{(k+1)\gamma}} a_k$$
$$ a_o = 1 $$
$$ \gamma = {\pi \over 2n} $$

**Discrete difference equation of a Nth order Butterworth**

In order to discretize the continuos function, the bilinear transform were applied giving us the result of a transfer function in the z domain

$$ s = {2 \over \Delta t} ({ 1-z^{-1} \over {1+z^{-1}} }) $$

Then assuming a sampling frequency of 1KHz we obtained this difference equation (Cannot use an exact frequency since there are no real time control on the loop)

$$ y[k]=a[0]*y[k-1]+a[1]*y[k-2]+b[0]*x[k]+b[1]*x[k-1]+b[2]*x[k-2] $$

The following coefficients were used
$$ A = [{1.95558189, -0.95654717}] $$
$$ B = [{0.00024132, 0.00048264, 0.00024132}] $$